# WorkPartner 快速开始指南

## 项目简介

WorkPartner 是一个用于处理Excel文件数据补充和完整性检查的命令行工具。主要功能包括：

- 解析固定格式的Excel文件名
- 读取Excel数据并识别缺失值
- 使用前后数据平均值补充缺失数据
- 检查数据完整性并补充缺失文件

## 系统要求

- .NET 8.0 或更高版本
- Windows 10/11 或 Linux/macOS
- 至少 2GB 可用内存
- 足够的磁盘空间存储输出文件

## 安装步骤

### 1. 克隆项目
```bash
git clone <repository-url>
cd WorkPartner
```

### 2. 安装依赖
```bash
dotnet restore
```

### 3. 构建项目
```bash
dotnet build
```

### 4. 运行项目
```bash
dotnet run -- <input_folder> [output_folder]
```

## 使用方法

### 基本用法
```bash
# 处理指定文件夹中的Excel文件
WorkPartner.exe "C:\ExcelFiles" "C:\Output"

# 使用默认输出目录（输入目录下的Processed文件夹）
WorkPartner.exe "C:\ExcelFiles"
```

### 命令行参数
- `input_folder` (必需): 包含Excel文件的输入文件夹路径
- `output_folder` (可选): 输出文件夹路径，默认为 `input_folder\Processed`

### 示例
```bash
# 处理项目数据文件夹
WorkPartner.exe "E:\项目数据\云港城项目" "E:\项目数据\处理结果"

# 使用相对路径
WorkPartner.exe ".\数据文件" ".\结果文件"
```

## 文件格式要求

### 文件名格式
Excel文件名必须符合以下格式：
```
日期-时项目名称.xls
```

**示例**：
- `2025.4.20-16云港城项目4#地块.xls`
- `2025.4.21-8云港城项目4#地块.xls`
- `2025.4.21-0云港城项目4#地块.xls`

**格式说明**：
- 日期：YYYY.M.D 格式
- 时：0-23 的小时数
- 项目名称：任意字符串
- 扩展名：.xls 或 .xlsx

### Excel数据格式
Excel文件必须包含以下数据：
- 数据名称：B5-B368 行
- 数据值：D5-I5 列（每行对应B列的名称）
- 空值表示缺失数据

## 处理流程

### 1. 文件扫描
- 扫描输入文件夹中的所有Excel文件
- 解析文件名格式
- 按日期和时间排序

### 2. 数据读取
- 读取每个Excel文件的B5-B368行数据名称
- 读取D5-I5列的数据值
- 识别空值作为缺失数据

### 3. 数据补充
- 按时间顺序处理文件
- 对于每个缺失数据点：
  - 查找前后文件中相同名称的非空值
  - 计算平均值
  - 用平均值替换空值

### 4. 完整性检查
- 按日期分组文件
- 检查每天是否有0、8、16三个时间点的数据
- 缺失时复制当天文件并重命名

### 5. 输出结果
- 保存处理后的Excel文件到输出目录
- 保持原文件名格式
- 生成处理报告

## 输出结果

### 文件结构
```
输出目录/
├── 2025.4.20-0云港城项目4#地块.xls
├── 2025.4.20-8云港城项目4#地块.xls
├── 2025.4.20-16云港城项目4#地块.xls
├── 2025.4.21-0云港城项目4#地块.xls
├── 2025.4.21-8云港城项目4#地块.xls
├── 2025.4.21-16云港城项目4#地块.xls
└── processing_report.txt
```

### 处理报告
程序会生成一个处理报告文件，包含：
- 处理的文件数量
- 补充的数据点数量
- 缺失的文件数量
- 错误信息（如果有）

## 常见问题

### Q: 程序无法启动
**A**: 检查是否安装了.NET 8.0运行时
```bash
dotnet --version
```

### Q: 文件读取失败
**A**: 检查文件是否被其他程序占用，确保有读取权限

### Q: 文件名解析失败
**A**: 确保文件名符合指定格式，检查日期和时间格式

### Q: 内存不足
**A**: 关闭其他程序，或分批处理文件

### Q: 输出文件为空
**A**: 检查输入文件的数据格式，确保B5-B368行有数据

## 性能优化

### 大文件处理
- 程序会自动分批处理大文件
- 建议处理前关闭其他Excel程序
- 确保有足够的磁盘空间

### 内存使用
- 程序会及时释放不需要的内存
- 处理大量文件时建议分批进行

## 错误处理

### 常见错误
1. **文件不存在**: 检查输入路径是否正确
2. **权限不足**: 以管理员身份运行或检查文件权限
3. **格式错误**: 检查文件名和Excel数据格式
4. **内存不足**: 减少同时处理的文件数量

### 错误日志
程序会在控制台显示错误信息，详细日志保存在：
```
输出目录/logs/error.log
```

## 技术支持

### 日志文件
程序运行时会生成详细的日志文件：
- `logs/processing.log`: 处理过程日志
- `logs/error.log`: 错误日志
- `logs/performance.log`: 性能日志

### 调试模式
启用详细日志输出：
```bash
WorkPartner.exe "input_folder" "output_folder" --verbose
```

## 更新日志

### v1.0.0 (计划)
- 初始版本发布
- 支持基本的Excel数据处理
- 支持数据补充和完整性检查

## 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

## 贡献

欢迎提交 Issue 和 Pull Request 来改进项目。

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 GitHub Issue
- 发送邮件至项目维护者 